    :root {
        /* Paleta principal */
        --primary: #3498db;
        --primary-dark: #2980b9;
        --primary-light: #b3d8f6;
        --secondary: #2ecc71;
        --secondary-dark: #27ae60;
        --danger: #e74c3c;
        --danger-dark: #c0392b;
        --warning: #f39c12;
        --warning-dark: #e67e22;
        --info: #17a2b8;
        --info-dark: #138496;
        --light: #ffffff; /* alias usado en varias reglas */

        /* Surface & text (adaptable con .dark-mode) */
        --bg: #f5f7f9;           /* página */
        --surface: #ffffff;      /* contenedores, modales */
        --card-bg: #f5f7f9;      /* tarjetas internas */
        --input-bg: #ffffff;     /* inputs y selects */
        --muted: #95a5a6;        /* texto secundario */
        --border: #ddd;
        --text: #333;
        --text-light: #fff;

        /* Semantic colors (badges, states) */
        --success-bg: #d4edda; --success-text: #155724;
        --info-bg: #ccefff; --info-text: #004085; /* usado para badges */
        --part-bg: #cce5ff; --part-text: #004085;
        --consumable-bg: #fff3cd; --consumable-text: #856404;

        --mecanico-bg: #eef6ff;

        --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
        /* Bordes y estados adicionales */
        --success-border: #c3e6cb;
        --error-bg: #f8d7da; --error-text: #721c24; --error-border: #f5c6cb;
    }
.action-buttons {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    align-items: center;
}
    .dark-mode {
        /* Tonos ajustados para modo oscuro */
        --primary: #5dade2;
        --primary-dark: #3498db;
        --secondary: #58d68d;
        --secondary-dark: #2ecc71;
        --danger: #e74c3c;
        --danger-dark: #c0392b;
        --warning: #f39c12;
        --warning-dark: #e67e22;

        /* Surface & text en modo oscuro */
        --bg: #0f1720;          /* fondo principal */
        --surface: #111827;     /* contenedores */
        --card-bg: #0f1724;     /* tarjetas */
        --input-bg: #11131a;    /* inputs */
        --muted: #9aa4ac;
        --border: #2b3942;
        --text: #e6eef8;
        --text-light: #ffffff;

        /* Semantic colors adaptados */
        --success-bg: #153f2a; --success-text: #b7f2c9;
        --info-bg: #08323a; --info-text: #bfeaf8;
        --part-bg: #072634; --part-text: #bcdff6;
        --consumable-bg: #3a2b10; --consumable-text: #f5e6b8;

        --mecanico-bg: #0b2440;

        --shadow: 0 4px 18px rgba(0,0,0,0.6);
        --primary-light: #2b6f9e;
        --info: #17a2b8;
        --info-dark: #138496;
        --light: #11131a;
        --success-border: #153f2a;
        --error-bg: #3a1f20; --error-text: #f5d6d6; --error-border: #5a2b2c;
    }
    .dark-mode .receipt-preview {
        background: var(--card-bg) !important;
        color: var(--text) !important;
        border: 1px solid var(--border);
    }

    .dark-mode .receipt-header {
        border-bottom: 1px dashed var(--border);
    }

    .dark-mode .receipt-total {
        border-top: 1px dashed var(--border);
    }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        padding: 0;
        background-color: var(--bg);
        color: var(--text);
        border: none;
        border-radius: 6px;
    }
    /* Highlight visual temporal para filas nuevas */
    .highlight-row {
        animation: highlightFade 2.2s ease-in-out;
        background: rgba(46, 204, 113, 0.18);
    }
    @keyframes highlightFade {
        0% { background: rgba(46, 204, 113, 0.35); }
        100% { background: transparent; }
    }
    :root {
        --container-width: 98%;
        --container-max: 1800px; /* permitir aún más espacio en pantallas grandes */
        --page-side-gap: 8px; /* margen externo mínimo */
    }

    .container {
          /* Contenedor principal: ocupar casi toda la anchura del viewport con márgenes mínimos */
          width: calc(100% - (var(--page-side-gap) * 2));
          max-width: var(--container-max);
          margin: 8px auto;
          background: var(--surface);
          border-radius: 10px;
          box-shadow: var(--shadow);
          padding: 10px 12px; /* padding interior reducido para aprovechar ancho */
          transition: var(--transition);
          /* Asegurar que el contenedor esté en contexto de apilamiento por encima del fondo
              pero por debajo de modales/overlays que usan z-index alto. */
          position: relative;
          z-index: 1;
          box-sizing: border-box;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--border);
    }

    .header h1 {
        color: var(--primary);
        margin: 0;
        font-size: 28px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .theme-toggle {
        background: var(--primary);
        color: var(--text-light);
        border: none;
        border-radius: 50px;
        padding: 10px 15px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        transition: var(--transition);
    }

    .theme-toggle:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
    }

    /* Botones: estilo unificado, mayor protagonismo para primarios */
    .btn {
        padding: 10px 16px;
        background: var(--primary);
        color: var(--text-light);
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 10px rgba(16, 52, 84, 0.06);
    }

    .btn:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
    }

    /* Botones con paleta más accesible y específicos para acciones */
    .btn-primary {
        background: var(--primary);
        color: var(--text-light);
        box-shadow: 0 6px 18px rgba(52, 152, 219, 0.12);
    }
    .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); }

    .btn-success {
        background: var(--secondary);
        color: var(--text-light);
        box-shadow: 0 4px 12px rgba(46, 204, 113, 0.08);
    }
    .btn-success:hover { background: var(--secondary-dark); transform: translateY(-2px); }

    .btn-danger {
        background: var(--danger);
        color: var(--text-light);
        box-shadow: 0 4px 12px rgba(231, 76, 60, 0.08);
    }
    .btn-danger:hover { background: var(--danger-dark); transform: translateY(-2px); }

    .btn-warning {
        background: var(--warning);
        color: var(--dark);
        box-shadow: 0 4px 12px rgba(243, 156, 18, 0.06);
    }
    .btn-warning:hover { background: var(--warning-dark); transform: translateY(-2px); }

    .btn-info {
        background: var(--info);
        color: var(--text-light);
        box-shadow: 0 4px 12px rgba(23,162,184,0.06);
    }
    .btn-info:hover { background: var(--info-dark); transform: translateY(-2px); }

    .btn-icon {
        padding: 8px 10px;
        min-width: 40px;
        justify-content: center;
        border-radius: 8px;
    }

    /* Acción principal (ej: Guardar, Exportar, Importar) */
    .btn-main {
        padding: 12px 18px;
        font-size: 15px;
        border-radius: 12px;
    }

    .tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid var(--border);
        flex-wrap: wrap;
        gap: 5px;
    }

    .tab {
        padding: 10px 16px;
        cursor: pointer;
        background: var(--lighter);
        border: 1px solid var(--border);
        border-bottom: none;
        border-radius: 12px 12px 0 0;
        transition: background 0.12s ease, transform 0.12s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
    }

    .tab.active {
        background: var(--primary);
        color: var(--text-light);
        border-color: var(--primary);
        transform: translateY(-2px);
        box-shadow: 0 8px 26px rgba(52,152,219,0.12);
    }

    .tab:hover:not(.active) {
        background: rgba(52,152,219,0.06);
        color: var(--text);
    }

    .tab-content {
        display: none;
        animation: fadeIn 0.5s ease;
    }

    .tab-content.active {
        display: block;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .card {
        background: var(--lighter);
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 16px;
        box-shadow: var(--shadow);
        transition: var(--transition);
        width: 100%;
        height: auto;
    }

    .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid var(--border);
    }

    .card-header h3 {
        margin: 0;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .form-container {
        background: var(--card-bg);
        padding: 12px 14px; /* menos padding lateral */
        border-radius: 8px;
        margin-bottom: 16px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
        width: 100%;
        height: auto;
    }

    .form-row {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 15px;
    }

    /* Compact form variant: reduce spacing and height for dense display */
    .compact-form .form-row {
        gap: 8px;
        margin-bottom: 8px;
    }
    .compact-form .form-group {
        min-width: 160px;
    }
    .compact-form .form-group label { margin-bottom: 4px; font-size: 13px; }
    .compact-form .form-group input, .compact-form .form-group select, .compact-form .form-group textarea {
        padding: 6px 8px;
        font-size: 13px;
        border-radius: 8px;
    }
    .compact-form .card-header { margin-bottom: 8px; padding-bottom: 6px; }
    .compact-form .card { padding: 10px; }
    .compact-form .register-form {
        max-height: 640px;
        overflow-y: auto; /* permitir scroll interno si el contenido excede la altura */
        -webkit-overflow-scrolling: touch; /* smooth scrolling en iOS */
        padding-right: 6px; /* evitar que el contenido toque el borde al aparecer scrollbar */
    }

    /* Opcional: estilo sutil para scrollbar en navegadores que lo soportan */
    .compact-form .register-form::-webkit-scrollbar { width: 8px; }
    .compact-form .register-form::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.12); border-radius: 8px; }
    .dark-mode .compact-form .register-form::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); }

    .form-group {
        flex: 1;
        min-width: 200px;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--text);
        display: flex;
        align-items: center;
        gap: 5px;
    }

    /* Inputs y selects: fondo claro, bordes suaves y focus visible */
    .form-group input, .form-group select, .form-group textarea {
        width: 100%;
        padding: 12px 14px;
        border: 1px solid var(--border);
        border-radius: 10px;
        box-sizing: border-box;
        background: var(--input-bg);
        color: var(--text);
        transition: box-shadow 0.12s ease, border-color 0.12s ease;
        font-size: 15px;
    }

    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 6px 20px rgba(52,152,219,0.08);
    }

    /* Inputs del conteo más grandes y legibles */
    .conteo-vertical .den-row input { width:100px; padding:8px 10px; font-size:15px; border-radius:8px; }

    /* Totales con jerarquía clara */
    .large-text strong { font-size:16px; color: var(--primary); }
    #total-efectivo-contado { font-size:18px; font-weight:800; color:var(--secondary); margin-left:6px; }

    .btn.small { padding:8px 12px; font-size:14px; border-radius:8px; }

    /* Tabla de resumen: legible y con más espacio */
    .arqueo-table-medios thead th { font-size:13px; color:var(--muted); }
    .arqueo-table-medios tbody td { padding:10px 8px; font-size:15px; }
    .arqueo-table-medios tfoot th { font-size:15px; }

    /* Dark mode: ensure compact forms are readable */
    .dark-mode .compact-form .form-group label { color: var(--text); }
    .dark-mode .compact-form .form-group input, .dark-mode .compact-form .form-group select, .dark-mode .compact-form .form-group textarea { background: var(--input-bg); color: var(--text); border-color: var(--border); }

    /* nota: definición de .btn unificada arriba */

    th {
        background-color: var(--primary);
        color: var(--text-light);
        font-weight: 600;
        position: sticky;
        top: 0;
    }

    tr {
        transition: var(--transition);
    }

    /* Tablas: filas alternadas y hover sutil */
    tr:nth-child(even) { background-color: rgba(0,0,0,0.02); }
    tr:hover { background-color: rgba(52,152,219,0.06); transform: translateZ(0); }

    .table-container {
        overflow: hidden; /* manejaremos scroll interno */
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(16, 52, 84, 0.04);
        background: var(--surface);
        padding: 0;
        border: 1px solid var(--border);
        width: 100%;
        display: flex;
        flex-direction: column;
    }

    /* Tabla de registros: área con scroll interno para optimizar navegación */
    #register-table-wrapper {
        max-height: calc(100vh - 240px); /* deja espacio para header y controles */
        overflow-y: auto;
    }

    #register-table {
        width: 100%;
        border-collapse: collapse;
    }

    #register-table thead th {
        position: sticky;
        top: 0;
        background: var(--primary);
        color: var(--text-light);
        z-index: 2;
        padding: 8px 10px;
        text-align: left;
    }

    #register-table tbody td {
        padding: 8px 10px; /* compact row */
        border-top: 1px solid var(--border);
        font-size: 13px;
    }

    #register-table tbody tr:hover { background: rgba(52,152,219,0.04); }

    .badge {
        display: inline-block;
        padding: 5px 10px;
        border-radius: 50px;
        font-size: 12px;
        font-weight: bold;
        margin-right: 5px;
    }

    .badge-service { background: var(--success-bg); color: var(--success-text); }
    .badge-part { background: var(--part-bg); color: var(--part-text); }
    .badge-consumable { background: var(--consumable-bg); color: var(--consumable-text); }

    .notification {
        padding: 12px 15px;
        margin: 10px 0;
        border-radius: 6px;
        display: none;
        animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
        from { opacity: 0; transform: translateX(-20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .success {
        background: var(--success-bg);
        color: var(--success-text);
        border: 1px solid var(--success-border);
    }

    .error {
        background: var(--error-bg);
        color: var(--error-text);
        border: 1px solid var(--error-border);
    }

    .warning {
        background: var(--consumable-bg);
        color: var(--consumable-text);
        border: 1px solid rgba(0,0,0,0.06);
    }

    /* Forzar visibilidad del botón cancelar edición en entorno real */
    .btn-cancel-edit {
        display: inline-block !important;
        margin-left: 8px;
    }

    /* Mejoras para vista previa e impresión en impresoras de vouchers */
    .receipt-preview {
        background: var(--card-bg);
        padding: 10px;
        border-radius: 6px;
        margin-top: 12px;
        box-shadow: var(--shadow);
        max-width: 320px; /* tamaño pensado para vouchers */
        width: 320px;
        font-family: 'Courier New', monospace;
        font-size: 12px;
    }

    /* .receipt-printable se define más abajo con reglas para impresión */

    @media print {
        body * { visibility: hidden; }
        .receipt-printable, .receipt-printable * { visibility: visible; }
        .receipt-printable { position: absolute; left: 0; top: 0; width: 320px; }
    }

    /* Reglas optimizadas para impresión tipo voucher (márgenes reducidos, tipografía compacta) */
    @media print {
        @page { margin: 4mm 6mm; }
        html, body { width: 320px; height: auto; margin: 0; padding: 0; }
        /* Ocultar elementos de UI que no forman parte del voucher */
        header, nav, .sidebar, .btn, .notification, .modal-overlay, .modal { display: none !important; }
        /* Asegurar que la nota de venta ocupe todo el ancho del papel térmico */
        .receipt-printable { width: 100% !important; position: static !important; visibility: visible !important; }
        .receipt-printable .receipt-header { text-align: center; margin-bottom: 6px; }
        .receipt-printable .receipt-item { display: flex; justify-content: space-between; font-size: 11px; }
        .receipt-printable .receipt-total { font-weight: 700; margin-top: 6px; text-align: right; }
        .receipt-printable { font-family: 'Courier New', monospace; font-size: 11px; padding: 6px; background: transparent; box-shadow: none; border-radius: 0; }
        /* Remover sombras y bordes para impresión limpia */
        .receipt-printable, .receipt-printable * { box-shadow: none !important; border: none !important; }
    }

    /* Mejor scroll visual para pestañas y formularios */
    .register-form-container::-webkit-scrollbar, .multi-register-tabs::-webkit-scrollbar { height: 8px; }
    .register-form-container::-webkit-scrollbar-track, .multi-register-tabs::-webkit-scrollbar-track { background: transparent; }
    .register-form-container::-webkit-scrollbar-thumb, .multi-register-tabs::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.15); border-radius: 4px; }


    .hidden {
        display: none;
    }

    .productos-seleccionados, .mecanicos-seleccionados {
        margin: 10px 0;
        padding: 12px;
        background: var(--card-bg);
        border-radius: 8px;
        border: 1px solid var(--border);
        min-width: 240px;
    }

    .producto-item, .mecanico-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        border-bottom: 1px solid var(--border);
        transition: var(--transition);
    }

    .mecanico-tag {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 10px;
        border-radius: 20px;
        background: var(--mecanico-bg);
        color: var(--text);
        margin-right: 8px;
        margin-bottom: 6px;
    }
    .mecanico-tag button { background: transparent; border: none; color: var(--danger); cursor: pointer; }

    /* Asegurar tabla de mecánicos tenga espacio similar al catálogo */
    .mecanicos-table-container {
        width: 100%;
        max-width: 720px; /* similar a catálogo */
    }

    /* Dark-mode: mejorar contraste en tablas e inputs */
    .dark-mode #register-table thead th { background: var(--primary-dark); color: var(--text-light); }
    .dark-mode #register-table tbody td { color: var(--text); }
    .dark-mode .table-container { background: var(--surface); border-color: var(--border); }
    .dark-mode input, .dark-mode select, .dark-mode textarea { background: var(--input-bg); color: var(--text); border-color: var(--border); }

    /* Modal simple para agregar producto personalizado */
     /* Overlay usado por modales: por defecto está oculto (display:none) y solo se muestra cuando el JS
         lo setea a 'flex'. Si observas oscurecimiento inesperado atrás del formulario, revisa dónde
         el código modifica `display`. */
     .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.4); display: none; align-items: center; justify-content: center; z-index: 9999; }
    .modal { background: var(--surface); padding: 18px; border-radius: 8px; width: 480px; max-width: 95%; box-shadow: var(--shadow); }
    .modal .modal-header { font-weight: 700; margin-bottom: 10px; }
    .modal .modal-actions { display:flex; justify-content:flex-end; gap:10px; margin-top:12px; }

    /* Modal-card específico usado en arqueo (resumen y edición) */
    .modal-card {
        background: var(--surface);
        color: var(--text);
        padding: 18px;
        border-radius: 10px;
        width: 720px;
        max-width: 96%;
        box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    .modal-card h4 { margin: 0 0 8px 0; color: var(--primary); }
    .modal-card .form-group { margin-bottom: 8px; }
    .modal-overlay[style], .modal-overlay { display: flex; }

    /* Botón de impresión/descarga en modal */
    .modal-card .btn-print { background: transparent; color: var(--primary); border: 1px solid var(--primary); padding: 8px 12px; border-radius: 8px; }
    .modal-card .btn-print:hover { background: var(--primary); color: var(--text-light); }

    /* Dark-mode specific modal adjustments */
    .dark-mode .modal-card { background: var(--card-bg); color: var(--text-light); box-shadow: 0 10px 30px rgba(0,0,0,0.6); }
    .dark-mode .modal-card h4 { color: var(--primary-light); }
    .dark-mode .modal-card .btn-print { border-color: var(--primary-light); color: var(--primary-light); }

    /* Print-friendly view: mostrar solo el modal de resumen para imprimir */
    @media print {
        body * { visibility: hidden; }
        .modal-card, .modal-card * { visibility: visible; }
        .modal-card { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none; }
        .modal-card { background: #fff; color: #000; }
        .dark-mode .modal-card { background: #111; color: #fff; }
    }

    /* Preview area inside modal for printing/previewing
       Ensure readable spacing and borders in both themes */
    .print-preview { background: var(--card-bg); color: var(--text); padding: 12px; border-radius: 6px; }
    .print-card { background: var(--surface); color: var(--text); padding: 12px; border-radius: 6px; border: 1px solid var(--border); }
    .dark-mode .print-preview, .dark-mode .print-card { background: var(--card-bg); color: var(--text-light); border-color: var(--border); }

    /* Branding header for printable preview */
    .print-header { text-align: left; margin-bottom: 8px; }
    .print-header h3 { margin: 0; color: var(--primary); font-size: 20px; }
    .print-header .print-sub { color: var(--muted); font-size: 13px; margin-top: 4px; }
    .modal-card .print-header { margin-bottom: 12px; }
    .print-card p { margin: 6px 0; }
    .dark-mode .print-header h3 { color: var(--primary-light); }

    .producto-item:last-child, .mecanico-item:last-child {
        border-bottom: none;
    }

    .producto-item:hover, .mecanico-item:hover {
        background: rgba(52, 152, 219, 0.1);
        border-radius: 6px;
    }

    .currency {
        font-weight: bold;
        color: var(--primary);
    }

    /* Arqueo - ajustar colores en modo oscuro */
    .arqueo-conteo, .arqueo-resumen, .arqueo-historial {
        background: var(--lighter);
        color: var(--text);
    }

    /* En dark mode, asegurarse que los textos tipo 'S/' y totales sean legibles */
    .dark-mode .arqueo-conteo, .dark-mode .arqueo-resumen, .dark-mode .arqueo-historial {
        background: var(--dark);
        color: var(--text-light);
    }

    /* Afectar elementos que contienen la moneda (S/) */
    .arqueo-conteo label, .arqueo-conteo strong, .arqueo-conteo .den-row label, .arqueo-resumen .resumen-box strong, .arqueo-resumen .resumen-box span {
        color: var(--text);
    }
    .dark-mode .arqueo-conteo label, .dark-mode .arqueo-conteo strong, .dark-mode .arqueo-conteo .den-row label, .dark-mode .arqueo-resumen .resumen-box strong, .dark-mode .arqueo-resumen .resumen-box span {
        color: var(--text-light);
    }

    /* Asegurar que el span con total-efectivo-contado sea visible en modo oscuro */
    .dark-mode #total-efectivo-contado { color: var(--secondary); font-weight: 700; }

/* Forzar colores legibles en el bloque de arqueo incluso si el HTML usa estilos inline */
.dark-mode .arqueo-conteo [style], .dark-mode .arqueo-conteo .denominations, .dark-mode .arqueo-conteo .den-row {
    background: var(--dark) !important;
    color: var(--text-light) !important;
}
.dark-mode .arqueo-conteo .den-row label {
    color: var(--text-light) !important;
}
.dark-mode .arqueo-conteo .den-input {
    background: var(--input-bg) !important;
    color: var(--text-light) !important;
    border: 1px solid var(--border) !important;
}
.dark-mode .arqueo-conteo strong {
    color: var(--text-light) !important;
}

    .autosave-indicator {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: var(--secondary);
        color: var(--text-light);
        padding: 10px 15px;
        border-radius: 50px;
        font-size: 14px;
        display: none;
        z-index: 1000;
        box-shadow: var(--shadow);
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }

    .category-filters {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }

    .category-filter {
        padding: 8px 15px;
        border: 1px solid var(--border);
        border-radius: 50px;
        cursor: pointer;
        transition: var(--transition);
        font-size: 14px;
    }

    .category-filter.active {
        background: var(--primary);
        color: var(--text-light);
        border-color: var(--primary);
    }

    .category-filter:hover:not(.active) {
        background: var(--primary);
        color: var(--text-light);
        opacity: 0.8;
    }

    .mecanico-tag {
        display: inline-flex;
        align-items: center;
        background: var(--primary);
        color: var(--text-light);
        padding: 5px 12px;
        border-radius: 50px;
        margin: 5px;
        font-size: 13px;
        transition: var(--transition);
    }

    .mecanico-tag button {
        background: none;
        border: none;
        margin-left: 8px;
        cursor: pointer;
        color: var(--text-light);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .mecanico-tag:hover {
        background: var(--primary-dark);
        transform: translateY(-2px);
    }

    .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
    }

    .summary-item {
        background: var(--lighter);
        padding: 20px;
        border-radius: 8px;
        box-shadow: var(--shadow);
        transition: var(--transition);
    }

    .summary-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
    }

    .summary-item h4 {
        margin: 0 0 10px 0;
        color: var(--primary);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .summary-value {
        font-size: 24px;
        font-weight: bold;
        color: var(--primary);
    }

    /* Nuevos estilos para mejoras */
    .searchable-select {
        position: relative;
    }

    /* Advertencia visual para inputs (ej. placa con formato no convencional) */
    .input-warning {
        border-color: var(--warning) !important;
        box-shadow: 0 4px 10px rgba(243,156,18,0.08);
    }

    .searchable-select input {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--border);
        border-radius: 6px;
        box-sizing: border-box;
        background: var(--input-bg);
        color: var(--text);
        font-size: 14px;
    }

    .searchable-options {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--surface);
        border: 1px solid var(--border);
        border-top: none;
        border-radius: 0 0 6px 6px;
        max-height: 200px;
        overflow-y: auto;
        z-index: 100;
        display: none;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .searchable-option {
        padding: 8px 12px;
        cursor: pointer;
        border-bottom: 1px solid var(--border);
        transition: var(--transition);
        font-size: 14px;
    }

    .searchable-option:last-child {
        border-bottom: none;
    }

    .searchable-option:hover {
        background: var(--primary);
        color: var(--text-light);
    }

    .searchable-option-group {
        background: var(--lighter);
        font-weight: bold;
        padding: 8px 12px;
        border-bottom: 1px solid var(--border);
        font-size: 14px;
    }

    .product-edit-form {
        background: var(--card-bg);
        padding: 15px;
        border-radius: 12px;
        margin-top: 10px;
        border: 1px solid var(--border);
        box-shadow: 0 8px 24px rgba(16,52,84,0.04);
    }

    .edit-mode .view-mode {
        display: none;
    }

    .edit-mode .edit-mode {
        display: block;
    }

    .edit-mode {
        display: none;
    }

    /* Banner modo edición */
    .edit-banner {
        background: linear-gradient(90deg, var(--warning), var(--warning-dark));
        color: var(--text-light);
        padding: 8px 12px;
        border-radius: 6px;
        margin-bottom: 10px;
        font-weight: 700;
    }

    /* Modal simple para compras */
    .modal-backdrop {
        position: fixed;
        left: 0; right: 0; top: 0; bottom: 0;
        background: rgba(0,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
    }

    .modal {
        background: var(--surface);
        padding: 20px;
        border-radius: 8px;
        width: 90%;
        max-width: 800px;
        box-shadow: var(--shadow);
    }

    .modal .modal-actions {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 10px;
    }

    .price-editor {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .price-editor input {
        width: 80px;
    }

    /* Estilos para vista previa de recibo */
    .receipt-preview {
        background: var(--card-bg);
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
        box-shadow: var(--shadow);
        max-width: 300px;
        font-family: 'Courier New', monospace;
    }

    .receipt-header {
        text-align: center;
        border-bottom: 1px dashed var(--border);
        padding-bottom: 10px;
        margin-bottom: 10px;
    }

    .receipt-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
    }

    .receipt-total {
        border-top: 1px dashed var(--border);
        padding-top: 10px;
        margin-top: 10px;
        font-weight: bold;
    }

    /* Estilos para múltiples registros */
    .multi-register-tabs {
        display: flex;
        gap: 8px;
        margin-bottom: 12px;
        flex-wrap: nowrap;
        overflow-x: auto;
        scroll-snap-type: x proximity;
    }

    .register-tab {
        padding: 8px 12px;
        background: var(--lighter);
        border: 1px solid var(--border);
        border-radius: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: var(--transition);
        scroll-snap-align: start;
    }

    .register-tab.active {
        background: var(--primary);
        color: var(--text-light);
        border-color: var(--primary);
    }

    .register-form-container {
        display: flex;
        flex-direction: row;
        gap: 12px;
        flex-wrap: nowrap;
        overflow-x: auto;
        align-items: flex-start;
        padding-bottom: 8px;
        min-height: 0; /* permitir que los formularios ocupen su altura natural */
        scroll-snap-type: x mandatory;
        /* UX: evitar que el contenedor capture el overscroll y permita forwarding suave */
        overscroll-behavior: contain;
        -webkit-overflow-scrolling: touch;
        scroll-behavior: smooth;
    }

    .register-form {
        /* Ajustar ancho para permitir ver 5-6 formularios en pantallas anchas */
        min-width: 260px; /* reducir para permitir más columnas */
        max-width: 380px;
        flex: 0 0 calc((100% - 60px) / 6); /* intentar encajar 6 formularios en el contenedor disponible */
        background: var(--lighter);
        padding: 12px 10px;
        border-radius: 12px;
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
        margin-bottom: 0;
        /* mantener tamaño estable pero permitir scroll si no hay espacio */
        transition: box-shadow 0.2s;
        scroll-snap-align: start;
        height: auto;
    }

    /* Si el cálculo anterior da menos que el min-width, usar min-width para evitar compactación excesiva */
    @media (min-width: 1600px) {
        .register-form { width: calc((var(--container-max) - 48px) / 6); }
    }

    @media (min-width: 1400px) and (max-width:1599px) {
        .register-form { width: calc((var(--container-max) - 48px) / 5); min-width: 280px; }
    }

    .register-form.active {
        display: block;
        border: 2px solid var(--primary);
    box-shadow: 0 0 0 2px var(--primary-light);
    }

    /* Filtros de fecha */
    .date-filters {
        display: flex;
        gap: 10px;
        margin-bottom: 15px;
        flex-wrap: wrap;
    }

    .date-filter {
        padding: 8px 15px;
        border: 1px solid var(--border);
        border-radius: 6px;
        cursor: pointer;
        transition: var(--transition);
        font-size: 14px;
    }

    .date-filter.active {
        background: var(--primary);
        color: var(--text-light);
        border-color: var(--primary);
    }

    /* Estilos para arqueo de caja */
    .cash-count {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 15px;
    }

    .denomination-row {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .denomination-row label {
        min-width: 100px;
    }

    .denomination-row input {
        width: 80px;
        text-align: right;
    }

    .denomination-total {
        font-weight: bold;
        min-width: 100px;
        text-align: right;
    }

    .payment-method-summary {
        background: var(--lighter);
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 15px;
        border: 1px solid var(--border);
    }

    .cash-difference {
        font-size: 18px;
        font-weight: bold;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        margin-top: 15px;
    }

    .positive-difference {
        background: var(--success-bg);
        color: var(--success-text);
        border: 1px solid var(--success-border);
    }

    .negative-difference {
        background: var(--error-bg);
        color: var(--error-text);
        border: 1px solid var(--error-border);
    }

    .payment-methods {
        margin: 15px 0;
    }

    .payment-method {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
    }

    .payment-total {
        font-weight: bold;
        margin-top: 10px;
        text-align: right;
    }

    /* Mejoras responsive */
    @media (max-width: 768px) {
        .form-row {
            flex-direction: column;
        }
        
        .form-group {
            min-width: 100%;
        }
        
        .action-buttons {
            justify-content: center;
    margin-top: 10px;
        }
        
        .tabs {
            flex-direction: column;
        }
        
        .tab {
            border-radius: 6px;
            margin-bottom: 5px;
        }
        
        .summary-grid {
            grid-template-columns: 1fr;
        }

        .price-editor {
            flex-direction: column;
            align-items: flex-start;
        }

        .register-form-container {
            flex-direction: column;
        }

        /* Inputs y botones más grandes en pantallas pequeñas */
        .btn { padding: 12px 16px; font-size: 15px; }
        .form-group input, .form-group select, .form-group textarea { padding: 12px; font-size: 15px; }

        .denomination-row {
            flex-wrap: wrap;
        }

        .multi-register-tabs {
            flex-direction: column;
        }
    }

    /* Dark-mode adjustments for searchable dropdowns */
    .dark-mode .searchable-options {
        background: var(--surface);
        border-color: var(--border);
        box-shadow: 0 6px 18px rgba(0,0,0,0.5);
    }

    .search-box {
        margin-bottom: 15px;
        display: flex;
        gap: 10px;
    }

    .search-box input {
        flex: 1;
        padding: 10px;
        border: 1px solid var(--border);
        border-radius: 6px;
    }

    .search-box button {
        padding: 10px 15px;
    }

    /* Utility classes added to replace inline styles in JS templates */
    .visually-hidden { visibility: hidden; height: 0; width: 0; overflow: hidden; position: absolute; }
    .mt-10 { margin-top: 10px; }
    .d-flex { display: flex; }
    .gap-8 { gap: 8px; }
    .space-between { justify-content: space-between; }
    .align-center { align-items: center; }
    .text-right { text-align: right; }
    .full-width { width: 100%; }
    .compact-input { width: auto; padding: 6px 8px; font-size: 13px; border-radius: 6px; }
    .form-group-end { align-self: flex-end; }
    .no-margin { margin-top: 0; }
    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .card-inner { background: var(--card-bg); padding: 8px; border-radius: 6px; }
    .large-text { font-size: 1.05em; }
    .list-compact { margin: 0 0 8px 0; padding-left: 18px; }
    .text-danger { color: var(--danger); }
    .text-success { color: var(--secondary); }

    /* Modal overlay/centered classes to replace inline modal styles */
    .modal-overlay, .modal-fulloverlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 10000; }
    .modal { background: var(--surface); padding: 20px; border-radius: 8px; width: 90%; max-width: 800px; box-shadow: var(--shadow); }
    .modal-centered { max-width: 420px; width: 420px; max-width: 95%; }

    /* Small helpers */
    .gap-8 > * + * { margin-left: 8px; }

    /* Arqueo - tablas y paneles */
    .arqueo-card { margin: 8px 0; padding: 12px; background: var(--card-bg, #fff); border-radius:8px; box-shadow: 0 1px 2px rgba(0,0,0,0.04); }
    .arqueo-table-medios { width:100%; border-collapse: collapse; font-size:14px; }
    .arqueo-table-medios th, .arqueo-table-medios td { padding:8px 10px; border-bottom: 1px solid rgba(0,0,0,0.05); }
    .arqueo-table-medios thead th { text-align:left; font-weight:600; color:var(--muted,#444); }
    .arqueo-table-medios tfoot th { border-top:2px solid rgba(0,0,0,0.06); }
    .text-right { text-align:right; }

    .resumen-grid { display:flex; gap:16px; align-items:flex-start; }
    .resumen-left { flex: 1 1 60%; }
    .resumen-right { flex: 0 0 320px; }
    .resumen-card { padding:10px; margin-bottom:12px; }
    .resumen-row { display:flex; justify-content:space-between; padding:6px 0; }

    .indicadores-grid { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    .ind-card { padding:10px; border-radius:8px; background: var(--card-bg,#fff); box-shadow: 0 1px 2px rgba(0,0,0,0.04); }
    .ind-title { font-size:12px; color:var(--muted,#666); }
    .ind-value { font-size:18px; font-weight:700; margin-top:6px; }
    .ind-diff.ok { border-left:4px solid #28a745; }
    .ind-diff.warning { border-left:4px solid #ffc107; }
    .ind-diff.danger { border-left:4px solid #dc3545; }

    @media (max-width: 900px) {
        .resumen-grid { flex-direction:column; }
        .resumen-right { width:100%; }
        .indicadores-grid { grid-template-columns: 1fr 1fr; }
    }

    @media (max-width: 520px) {
        .indicadores-grid { grid-template-columns: 1fr; }
    }

    /* Conteo vertical compacto - optimizado para UX compacto */
    .conteo-vertical { display:flex; flex-direction:column; gap:6px; max-width:360px; }
    .conteo-vertical .den-row { display:flex; align-items:center; gap:8px; justify-content:space-between; padding:6px 10px; border-radius:8px; background: var(--card-bg); border:1px solid var(--border); }
    .conteo-vertical .den-row label { min-width:64px; font-weight:700; font-size:14px; }
    .conteo-vertical .den-row input { width:84px; text-align:right; padding:6px 8px; border-radius:8px; font-weight:600; }
    .den-subtotal { min-width:86px; text-align:right; font-weight:700; color:var(--primary); }
    .conteo-actions { display:flex; justify-content:flex-end; align-items:center; gap:8px; margin-top:10px; flex-wrap:wrap; }
    .btn.small { padding:6px 10px; font-size:13px; border-radius:8px; }

    /* Resumen general: contenedor tipo tarjeta con tabla optimizada */
    .resumen-card { padding:12px; border-radius:10px; background: var(--surface); box-shadow: var(--shadow); }
    .arqueo-table { width:100%; border-collapse: collapse; margin-top:6px; }
    .arqueo-table thead th { background: transparent; color: var(--muted); font-weight:700; text-align:left; padding:8px; }
    .arqueo-table tbody td { padding:8px; border-top:1px solid var(--border); }
    .arqueo-historial table { width:100%; }

    @media (max-width: 900px) {
        .conteo-vertical { max-width: 100%; }
        .resumen-right { order: 2; }
        .resumen-left { order: 1; }
    }

    /* Appeal: reduce margins between resumen cards and tables for denser layout */
    /* Layout lateral: conteo (izq) + resumen (der) */
    /* Contenedor unificado para conteo + resumen */
    .arqueo-grid { display:grid; grid-template-columns: 1fr minmax(280px, 40%); gap:0; align-items:start; background: var(--surface); border-radius:10px; padding:10px; box-shadow: var(--shadow); border: 1px solid var(--border); }
    .arqueo-grid > .arqueo-conteo { padding:8px 12px 12px 12px; border-radius:8px 0 0 8px; background: transparent; }
    .arqueo-grid > .arqueo-resumen { padding:8px 12px 12px 12px; border-left:1px solid var(--border); border-radius:0 8px 8px 0; background: transparent; }
    /* Si la pantalla es estrecha, cambiar a columna para que el resumen vaya debajo */
    @media (max-width: 980px) {
        .arqueo-grid { grid-template-columns: 1fr; padding:8px; }
        .arqueo-grid > .arqueo-conteo { border-radius:8px; }
        .arqueo-grid > .arqueo-resumen { border-left: none; border-radius:8px; margin-top:10px; }
    }

    /* Acciones colocadas debajo del conteo */
    .conteo-actions-bottom { margin-top:12px; }
    .actions-row { display:flex; gap:8px; flex-wrap:wrap; }
    .actions-row .btn { display:inline-flex; align-items:center; gap:8px; }

    /* Badge de confirmación de acción */
    .action-badge {
        display:inline-flex;
        align-items:center;
        justify-content:center;
        min-width:28px;
        height:28px;
        background: var(--secondary);
        color: var(--text-light);
        border-radius:50%;
        font-weight:700;
        box-shadow: 0 4px 10px rgba(0,0,0,0.12);
        margin-left:8px;
        transition: transform 0.18s ease, opacity 0.2s ease;
        opacity: 0.95;
    }
    .action-badge.badge-pop { transform: scale(1.28); }
